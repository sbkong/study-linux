#### 실시간 모니터링 
`sar 1` - 1초마다 새로고침
`sar 1 3` - 1초마다 새로고침 + 3회 출력

![[Pasted image 20240816111713.png]]

| 항목      | 설명                                                               |
| ------- | ---------------------------------------------------------------- |
| 시간      | 조사한 시간 시:분:초                                                     |
| CPU     | CPU 각 쓰레드 번호 또는 레벨(전체)                                           |
| %user   | 사용자 레벨에서 사용한 CPU 시간(%)                                           |
| %nice   | nice 우선순위로 사용자 레벨에서 사용한 CPU시간 비율(%)                              |
| %system | 시스템(커널) 레벨에서 사용한 CPU 시간(%)                                       |
| %iowait | I/O 요청 처리 완료를 기다리는 동안의 CPU시간(%)                                  |
| %irq    | 하드웨어 인터럽트를 처리하는 동안 기다린 CPU시간(%)                                  |
| %soft   | 소프트웨어 인터럽트를 처리하는 동안 기다린 CPU시간(%)                                 |
| %steal  | 하이퍼바이저가 다른 가상 프로세서를 서비스하는 동안 가상 CPU 및 CPU에 의해 비자발적 대기에서 보낸 시간(%) |
| %guest  | 가상 프로세스 수행을 위해 CPU를 사용한 시간(%)                                    |
| %idle   | 유휴 시간(%)                                                         |

#### 과거 데이터 조회 
`sar -f /var/log/sa/sa08 -s 20:00:00 -e 22:00:00`
- sysstat 패키지를 설치하면 자동으로 10분마다 시스템 정보를 저장함
- 저장 경로
	- CentOS: `/var/log/sa`
	- Ubuntu: `/var/log/sysstat`

#### 작업 큐의 길이와 부하 확인
`sar -q 1 3`

![[Pasted image 20240816113213.png]]

| 항목       | 설명                          |
| -------- | --------------------------- |
| runq-sz  | 실행 큐의 길이 (실행을 위해 대기하는 작업 수) |
| plist-sz | 작업 목록에 있는 작업 수              |
| idavg-1  | 평균 부하(1분)                   |
| idavg-5  | 평균 부하(5분)                   |
| idavg-15 | 평균 부하(15분)                  |

#### 작업 및 컨텍스트 스위칭(문맥교환) 통계
`sar -w 1 3`

![[Pasted image 20240816113711.png]]

| 항목      | 설명            |
| ------- | ------------- |
| proc/s  | 초당 생성된 작업 수   |
| cswch/s | 초당 컨텍스트 스위칭 수 |

#### 메모리 사용량 통계 보고
`sar -r 1 3`

![[Pasted image 20240816113832.png]]

| 항목         | 설명                                                                                             |
|--------------|--------------------------------------------------------------------------------------------------|
| kbmemfree    | 사용할 수 있는 여유 메모리양(kb)                                                                  |
| kbmemused    | 사용 중인 메모리양(kb)                                                                            |
| %memused     | 사용 중인 메모리 비율(%)                                                                          |
| kbbuffers    | 커널에 의해 버퍼로 사용 중인 메모리양(kb)                                                         |
| kbcached     | 커널에 의해 캐시로 사용 중인 메모리양(kb)                                                         |
| kbcommit     | 현재 워크로드를 위해서 필요한 물리적 메모리 예상치(kb)                                             |
| %commit      | RAM과 SWAP을 합친 크기에 비해 현재 워크로드를 위해 필요한 메모리 비율(%)                          |
| kbactive     | Active 메모리양(kb)                                                                               |
| kbinact      | Inactive 메모리양(kb)                                                                             |
| kbdirty      | 디스크에 기록하고 반답되기를 기다리는 메모리양(kb)                                                |

#### 페이징 통계
`sar -B 1 3`

![[Pasted image 20240816114048.png]]

| 항목        | 설명                                             |
| --------- | ---------------------------------------------- |
| pgpgin/s  | 초당 디스크에서 페이지 인(paged in)된 양(kb)                |
| pgpgout/s | 초당 디스크로 페이지 아웃(paged out)된 양(kb)               |
| fault/s   | 시스템에서 발생하는 모든 초당 페이지 실패(page faults)수          |
| majflt/s  | 시스템에서 발생한 주요 실패 수(디스크에서 메모리 페이지를 로딩할 때 발생한 오류) |
| pgfree/s  | 시스템에서 프리 목록에 들어가는 초당 페이지 수                     |
| pgscan/s  | kswapd 데몬에서 스캔한 초당 페이지 수                       |
| pgscank/s | 메모리 자원을 위해 스캔한 초당 페이지 수                        |
| pgsteal/s | 메모리 필요에 의해 스왑 아웃된 페이지 개수에서 시스템으로 요청된 초당 페이지 수  |
| %vmeff    | pgsteal/pgscan 의 % 계산한 값                       |

#### 스왑 영역 사용량
`sar -S 1 3`

![[Pasted image 20240816114729.png]]

| 항목        | 설명                          |
| --------- | --------------------------- |
| kbswpfree | SWAP 여유 공간(kb)              |
| kbswpused | 사용된 SWAP 공간(kb)             |
| %swpused  | SWAP 사용률(%)                 |
| kbswpcad  | 캐시된 스왑 메모리 크기(kb)           |
| %swpcad   | 사용된 스왑 영역에 비해 캐시된 스왑 메모리 비율 |

#### 스왑 영역 초당 사용량
`sar -W 1 3`

![[Pasted image 20240816114322.png]]

| 항목        | 설명                                               |
|-------------|----------------------------------------------------|
| pswpin/s    | 시스템으로 가져온 초당 SWAP 페이지 수               |
| pswpout/s   | 시스템에서 가져간 초당 SWAP 페이지 수               |

#### I/O & 전송률 통계
`sar -b 1 3`

![[Pasted image 20240816114913.png]]

| 항목       | 설명                                                        |
|------------|-------------------------------------------------------------|
| tps        | 물리적 디바이스에서 초당 전송된 데이터 개수 (데이터 크기는 알 수 없다) |
| rtps       | 물리적 디바이스에 요청된 초당 읽기 데이터 개수               |
| wtps       | 물리적 디바이스에 요청된 초당 쓰기 데이터 개수               |
| bread/s    | 물리적 디바이스에서 초당 읽은 블록의 데이터 크기             |
| bwrtn/s    | 물리적 디바이스에서 초당 기록한 블록의 데이터 크기           |

#### inode, 커널 테이블 확인
`sar -v 1 3`

![[Pasted image 20240816114948.png]]

| 항목       | 설명                                               |
|------------|----------------------------------------------------|
| dentunusd  | 디렉토리 캐시에서 사용하지 않은 캐시 항목 수       |
| file-nr    | 시스템에서 사용된 파일 핸들 수                     |
| inode-nr   | 시스템에서 사용된 아이노드 핸들 수                 |
| pty-nr     | 시스템에서 사용된 가상터미널(PTY) 수               |

#### 각 블록 장치의 활동 확인
`sar -d 1 3`

![[Pasted image 20240816115118.png]]

| 항목        | 설명                                                                                 |
|-------------|--------------------------------------------------------------------------------------|
| tps         | 물리적 디바이스에서 실행된 I/O 수                                                    |
| rd_sec/s    | 디바이스에서 읽은 섹터 수 (1섹터=512bytes)                                           |
| wr_sec/s    | 디바이스에 쓴 섹터 수                                                                |
| avgrq-sz    | 디바이스에 요청한 I/O 평균 크기(섹터)                                                |
| avgqu-sz    | 디바이스에 요청한 대기 중인 I/O 수                                                   |
| await       | 디바이스에 요청한 I/O 작업 평균 수행(처리+대기) 시간(ms)                             |
| svctm       | 디바이스에 요청한 I/O 작업 평균 처리 시간(ms)                                        |
| %util       | 이슈 발생시 I/O요청 경과 시간 비율(%) <br>(대역폭 활용률, 이 값이 100%에 가까워질수록 장치 포화가 발생된다) |

#### 네트워크 인터페이스 사용량 조회
`sar -n DEV 1 3 | egrep "IFACE|ens34s0"`
- egrep하지 않으면 모든 네트워크 인터페이스가 표시되므로 가독성이 떨어진다. ens34s0 인터페이스만 출력

![[Pasted image 20240816115327.png]]

| 항목       | 설명                                               |
|------------|----------------------------------------------------|
| IFACE      | 네트워크 인터페이스 이름                           |
| rpck/s     | 초당 수신 패킷 수                                   |
| tpck/s     | 초당 송신 패킷 수                                   |
| rxkB/s     | 초당 수신 데이터양(kBytes)                          |
| txkB/s     | 초당 송신 데이터양(kBytes)                          |
| rxcmp/s    | 초당 수신된 압축 패킷 수 (CSLIP 등)                 |
| txcmp/s    | 초당 송신된 압축 패킷 수                            |
| rxmcst/s   | 초당 수신된 멀티캐스트(multicast) 패킷 수          |

#### 네트워크 소켓 사용량 조회
`sar -n SOCK 1 3`

![[Pasted image 20240816115512.png]]

| 항목       | 설명                                               |
|------------|----------------------------------------------------|
| totsck     | 사용된 소켓(Socket) 총 수                          |
| tcpsck     | 사용된 TCP 소켓 수                                  |
| udpsck     | 사용된 UDP 소켓 수                                  |
| rawsck     | 사용된 RAW 소켓 수                                  |
| ip-frag    | 쌓여있는 IP fragment 수                             |
| tcp-tw     | TIME_WAIT 상태에 있는 TCP 소켓 수                  |

#### 네트워크 TCP 상태 조회
`sar -n TCP 1 3`

![[Pasted image 20240816115641.png]]

| 항목        | 설명                                                                                 |
|-------------|--------------------------------------------------------------------------------------|
| active/s    | CLOSED 상태에서 SYN-SENT 상태로 전환된 초당 TCP 커넥션 수 [tcpActiveOpens]            |
| passive/s   | LISTEN 상태에서 SYN-RCVD 상태로 전환된 초당 TCP 커넥션 수 [tcpPassiveOpens]           |
| iseg/s      | 초당 수신된 세그먼트의 수량 [tcpInSegs]                                               |
| oseg/s      | 초당 송신한 세그먼트의 수량 [tcpOutSegs]                                              |

